Since ontology is an e?ective tool to categorize real-world concepts, we choose it to model both queries and peer interests in the system. Since most well-known Web portal sites (e.g., Yahoo! Directory and Open Directory) provide freely accessible ontology structures to Internet users, it is straightforward that each peer, when joining the P2P overlay network, downloads and keeps a copy of the ontology structure from a speci?c Web portal. It is meaningful to assign weights to each path so as to capture peer preferences at a ?ner granularity. For the viability of similarity measurement among weighted ontology paths, we normalize the weights of all ontology paths (i.e., peer interests) at each peer and require the sum of the weights to be equal to 1. Since each pro?le consists of multiple weighted ontology
paths, we employ the well-established Earth Mover Distance (EMD) function [3] to measure the pairwise pro?le distance. We propose a light-weight decentralized clustering algorithm to build a hierarchical overlay network that groups peers according to the similarity of pro?les, which only requires a speci?ed number of peers to propagate their information in two phases over the whole network. The algorithm executes in multiple phases. In the initial phase, we randomly choose S pivot peers and all other peers a?liate with one of the pivots that has the most similar pro?le (based on EMD function), resulting in S groups with high probability. In the second and subsequent phases, groups with similar interests are recursively clustered together at higher levels. The algorithm completes when no more clustering can be achieved. Given a syntax-based query (e.g., a set of keywords), its corresponding ontology paths can be speci?ed based on the ontology. Users can manually specify weights to re?ect their preferences. A query is issued by an arbitrary peer p. Firstly, p propagates the query within the local leaf-level group through uniform gossip protocol. With high probability, the local leaf-level group contains the query results. Instead, when the query pro?le is not related to pâ€™s interests, but the data to be retrieved are well replicated in the entire overlay network, the results very probably are available within the local group. Otherwise, when the queries can not be satis?ed within the local group, they will be recursively routed towards remote groups via the hierarchical overlay network. The number of routing hops to forward a query to leaf-level groups is bounded by the height of the hierarchical overlay network (i.e., O(log2S)). 
