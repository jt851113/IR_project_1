To count the number of queries, the nodes record the corresponding
messages. One choice is to make the nodes, which process the
queries or updates, store the performed operations. But this scheme
leads to biased sampling result when some hotspot exists. To better
distribute the query and update information in the network, we
adopt a “footprint” scheme.
In BATON, a query will be processed in about O(log N) messages,
and about 6 log N messages are required for node joining
and 4 log N messages for node leaving. In the original protocol,
after receiving these messages, the routing node will process the
corresponding request (update routing finger table or forward the
message to other nodes). But no information about the actions are
recorded. In this paper, we exploit these messages to help the sampling
process.
After a query is issued from the user node, it will reach the destination
in about O(log N) nodes. Now, we require the node, which
routes a specific query Q, to add the following entry to its local
storage.
The query ID is generated by the system automatically and each
query has a unique ID. The node records when it receives the query
routing request. And after a time threshold T, if Q.time + T <
current_time, the record of query Q will be discarded. The query
range is used to infer the involved cells. In this way, a query will
generate about O(log N) footprints in the network.
Following the same idea, when a node joins or leaves the network,
we require it to mark its footprint in the corresponding nodes.
In BATON, once joining or leaving, the node sends notification
messages to nodes in its level and its parent level to correct the
routing fingers. If a node receives such notification message, it will
generate the following records:
(Event, Event.time)
Event indicates whether it is a join or leave operation. And the node
records the message time as well. The old records will be discarded
periodically. In BATON, node joining and leaving will create about
6log(N) and 4log(N) footprints in the network respectively.